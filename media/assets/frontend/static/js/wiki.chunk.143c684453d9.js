(this["webpackJsonpseahub-frontend"]=this["webpackJsonpseahub-frontend"]||[]).push([[34],{102:function(e,t,n){"use strict";var a=n(5),i=n(6),o=n(8),r=n(7),s=n(0),l=n.n(s),c=n(95),d=n(45),p=n(64),h=n(4),u=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).registerHandlers=function(){document.addEventListener("mousedown",i.handleOutsideClick),document.addEventListener("touchstart",i.handleOutsideClick),document.addEventListener("scroll",i.handleHide),document.addEventListener("contextmenu",i.handleHide),document.addEventListener("keydown",i.handleKeyNavigation),window.addEventListener("resize",i.handleHide)},i.unregisterHandlers=function(){document.removeEventListener("mousedown",i.handleOutsideClick),document.removeEventListener("touchstart",i.handleOutsideClick),document.removeEventListener("scroll",i.handleHide),document.removeEventListener("contextmenu",i.handleHide),document.removeEventListener("keydown",i.handleKeyNavigation),window.removeEventListener("resize",i.handleHide)},i.handleShow=function(e){if(e.detail.id===i.props.id&&!i.state.isVisible){var t=e.detail.position,n=t.x,a=t.y,o=e.detail,r=o.currentObject,s=o.menuList;i.setState({isVisible:!0,x:n,y:a,currentObject:r,menuList:s}),i.registerHandlers(),Object(p.a)(i.props.onShowMenu,e)}},i.handleHide=function(e){!i.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==i.props.id||(i.unregisterHandlers(),i.setState({isVisible:!1}),Object(p.a)(i.props.onHideMenu,e))},i.handleOutsideClick=function(e){i.menu.contains(e.target)||Object(d.c)()},i.handleMouseLeave=function(e){e.preventDefault(),i.props.hideOnLeave&&Object(d.c)()},i.handleContextMenu=function(e){i.handleHide(e)},i.handleKeyNavigation=function(e){!1!==i.state.isVisible&&(e.preventDefault(),i.hideMenu(e))},i.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||Object(d.c)()},i.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!i.menu)return n;var a=window,o=a.innerWidth,r=a.innerHeight,s=i.menu.getBoundingClientRect();return t+s.height>r&&(n.top-=s.height),e+s.width>o&&(n.left-=s.width),n.top<0&&(n.top=s.height<r?(r-s.height)/2:0),n.left<0&&(n.left=s.width<o?(o-s.width)/2:0),n},i.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={top:t,left:e};if(!i.menu)return n;var a=window,o=a.innerWidth,r=a.innerHeight,s=i.menu.getBoundingClientRect();return n.left=e-s.width,t+s.height>r&&(n.top-=s.height),n.left<0&&(n.left+=s.width),n.top<0&&(n.top=s.height<r?(r-s.height)/2:0),n.left+s.width>o&&(n.left=s.width<o?(o-s.width)/2:0),n},i.onMenuItemClick=function(e){e.stopPropagation();var t=h.a.getEventData(e,"operation"),n=i.state.currentObject;i.props.onMenuItemClick(t,n,e)},i.onContextMenu=function(e){e.stopPropagation()},i.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[]},i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.listenId=c.a.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t((function(){var n=e.state,a=n.x,i=n.y,o=e.props.rtl?e.getRTLMenuPosition(a,i):e.getMenuPosition(a,i),r=o.top,s=o.left;t((function(){e.menu&&(e.menu.style.top="".concat(r,"px"),e.menu.style.left="".concat(s,"px"),e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")}))}))}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&c.a.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:{position:"fixed",opacity:0,pointerEvents:"none",display:"block"},ref:function(t){e.menu=t}},this.state.menuList.map((function(t,n){return"Divider"===t?l.a.createElement("div",{key:n,className:"seafile-divider dropdown-divider"}):l.a.createElement("button",{key:n,className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick,onContextMenu:e.onContextMenu},t.value)})))}}]),n}(l.a.Component);t.a=u},1103:function(e,t,n){e.exports=n(1272)},1104:function(e,t,n){},1106:function(e,t,n){},1107:function(e,t,n){},112:function(e,t,n){"use strict";var a=n(5),i=n(6),o=n(8),r=n(7),s=n(0),l=n.n(s),c=n(95),d=n(3),p=n(1),h=n(4),u=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onShowMenu=function(){},i.onHideMenu=function(){i.state.isItemMenuShow&&(i.setState({isItemMenuShow:!1}),"function"===typeof i.props.unfreezeItem&&i.props.unfreezeItem())},i.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),i.toggleOperationMenu()},i.toggleOperationMenu=function(){i.setState({isItemMenuShow:!i.state.isItemMenuShow},(function(){i.state.isItemMenuShow&&"function"===typeof i.props.freezeItem?i.props.freezeItem():i.state.isItemMenuShow||"function"!==typeof i.props.unfreezeItem||i.props.unfreezeItem()}))},i.onMenuItemClick=function(e){var t=h.a.getEventData(e,"toggle"),n=i.props.item;i.props.onMenuItemClick(t,e,n)},i.state={menuList:[],isItemMenuShow:!1},i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=c.a.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&c.a.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,a=n.toggleClass,i=n.tagName;return a="sf-dropdown-toggle "+a,t.length?i&&"button"===i?l.a.createElement(d.d,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,title:Object(p.mb)("More Operations")},l.a.createElement(d.o,{className:a,"data-toggle":"dropdown",title:Object(p.mb)("More Operations"),"aria-expanded":this.state.isItemMenuShow}),l.a.createElement(d.n,null,t.map((function(t,n){return"Divider"===t?l.a.createElement(d.m,{key:n,divider:!0}):l.a.createElement(d.m,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)})))):l.a.createElement(d.l,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick},l.a.createElement(d.o,{tag:i||"i",className:a,title:Object(p.mb)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),l.a.createElement(d.n,null,t.map((function(t,n){return"Divider"===t?l.a.createElement(d.m,{key:n,divider:!0}):l.a.createElement(d.m,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)})))):""}}]),n}(l.a.Component);u.defaultProps={isHandleContextMenuEvent:!0,toggleClass:"sf2-icon-caret-down"},t.a=u},1272:function(e,t,n){"use strict";n.r(t);var a=n(5),i=n(6),o=n(8),r=n(7),s=n(0),l=n.n(s),c=n(23),d=n.n(c),p=n(12),h=n.n(p),u=n(57),m=n.n(u),f=n(3),v=n(1),k=n(4),g=n(9),E=n(68),w=n(101),N=n(69),b=n(70),C=n(14),D=n(253),M=n(41),L=(n(1104),function(){function e(t){var n=t.name,i=t.href,o=t.parentNode;Object(a.a)(this,e),this.name=n,this.href=i,this.parentNode=o||null,this.children=[]}return Object(i.a)(e,[{key:"setParent",value:function(e){this.parentNode=e}},{key:"addChildren",value:function(e){var t=this;e.forEach((function(e){e.setParent(t)})),this.children=e}}]),e}()),S=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).bindClickEvent=function(){i.links=document.querySelectorAll(".".concat("wiki-nav-content"," a")),i.links.forEach((function(e){e.addEventListener("click",i.onLinkClick)}))},i.removeClickEvent=function(){i.links.forEach((function(e){e.removeEventListener("click",i.onLinkClick)}))},i.onLinkClick=function(e){e.preventDefault();var t=e.target.getAttribute("data-path");if(t!==i.state.currentPath){t&&i.setState({currentPath:t});var n=i.getLink(e.target);n&&i.props.onLinkClick(n)}},i.getLink=function(e){var t=e.tagName;if(t&&"HTML"!==t)return"A"===t?e.href:i.getLink(e.parentNode)},i.changeInlineNode=function(e){var t;if("link"==e.type||"image"===e.type)if("image"==e.type&&v.xb){if(t=e.data.src,!new RegExp(v.Zb+"/lib/"+v.Ub+"/file.*raw=1").test(t))return;var n=t.indexOf("/file"),a=t.indexOf("?"),i=t.substring(n+5,a);e.data.src=v.Zb+"/view-image-via-public-wiki/?slug="+v.kc+"&path="+i}else if("link"==e.type){t=e.data.href;if(new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/).test(t)){if(k.a.isInternalMarkdownLink(t,v.Ub)){var o=k.a.getPathFromInternalMarkdownLink(t,v.Ub);e.data.href=v.Zb+"/published/"+v.kc+o}else if(k.a.isInternalDirLink(t,v.Ub)){var r=k.a.getPathFromInternalDirLink(t,v.Ub);e.data.href=v.Zb+"/published/"+v.kc+r}}else e.data.href=v.Zb+"/published/"+v.kc+"/"+t}return e},i.getRootNode=function(){var e=Object(M.a)(i.props.indexContent);k.a.changeMarkdownNodes(e,i.changeInlineNode).map((function(e){if("unordered_list"===e.type||"ordered_list"===e.type){var t=i.transSlateToTree(e.children,i.treeRoot);i.setNodePath(t,"/"),i.treeRoot=t}}))},i.setNodePath=function(e,t){var n=e.name,a="/"===t?t+n:t+"/"+n;e.path=a,e.children.length>0&&e.children.map((function(e){i.setNodePath(e,a)}))},i.transSlateToTree=function(e,t){var n=e.map((function(e){if(2!==e.children.length||"unordered_list"!==e.children[1].type&&"ordered_list"!==e.children[1].type)return e.children[0]&&"paragraph"===e.children[0].type?i.transParagraph(e.children[0]):new L({name:"",href:""});var t=e.children[0],n=i.transParagraph(t),a=e.children[1];return i.transSlateToTree(a.children,n)}));return t.addChildren(n),t},i.transParagraph=function(e){var t;if(e.children[1]&&"link"===e.children[1].type){var n=e.children[1],a=n.children[0],i=a?a.text:"";t=new L({name:i,href:n.data.href})}else if("text"===e.children[0].object){var o=e.children[0],r=o.text?o.text:"";t=new L({name:r,href:""})}else t=new L({name:"",href:""});return t},i.links=[],i.treeRoot=new L({name:"",href:""}),i.state={currentPath:""},i}return Object(i.a)(n,[{key:"componentWillMount",value:function(){this.getRootNode()}},{key:"componentDidMount",value:function(){this.bindClickEvent()}},{key:"componentWillReceiveProps",value:function(){this.removeClickEvent()}},{key:"componentDidUpdate",value:function(){this.bindClickEvent()}},{key:"componentWillUnmount",value:function(){this.removeClickEvent()}},{key:"render",value:function(){return l.a.createElement("div",{className:"mx-4 o-hidden"},l.a.createElement(y,{node:this.treeRoot,bindClickEvent:this.bindClickEvent,currentPath:this.state.currentPath}))}}]),n}(l.a.Component),y=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).toggleExpanded=function(){i.setState({expanded:!i.state.expanded},(function(){i.state.expanded&&i.props.bindClickEvent()}))},i.renderLink=function(e){var t=e.href,n=e.name,a=e.path,o="wiki-nav-content ".concat(a===i.props.currentPath?"wiki-nav-content-highlight":"");return t&&n?l.a.createElement("div",{className:o},l.a.createElement("a",{href:t,"data-path":a,onClick:i.toggleExpanded,title:n},n)):n?l.a.createElement("div",{className:"wiki-nav-content"},l.a.createElement("span",{onClick:i.toggleExpanded,title:n},n)):null},i.state={expanded:!1},i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.node&&!this.props.node.parentNode&&this.setState({expanded:!0},(function(){e.props.bindClickEvent()}))}},{key:"render",value:function(){var e=this,t=this.props.node;return t.children.length>0?l.a.createElement(l.a.Fragment,null,t.parentNode&&l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"switch-btn",onClick:this.toggleExpanded},this.state.expanded?l.a.createElement("i",{className:"fa fa-caret-down"}):l.a.createElement("i",{className:"fa fa-caret-right"})),this.renderLink(t)),this.state.expanded&&t.children.map((function(t,a){return l.a.createElement("div",{className:"pl-4 position-relative",key:a},l.a.createElement(n,{node:t,bindClickEvent:e.props.bindClickEvent,currentPath:e.props.currentPath}))}))):this.renderLink(t)}}]),n}(l.a.Component),I=S,x=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).renderIndexView=function(){return l.a.createElement(s.Fragment,null,l.a.createElement("h3",{className:"wiki-pages-heading"},Object(v.mb)("Contents")),l.a.createElement("div",{className:"wiki-pages-container"},l.a.createElement(I,{indexContent:i.props.indexContent,onLinkClick:i.props.onLinkClick})))},i.renderTreeView=function(){return l.a.createElement(s.Fragment,null,l.a.createElement("h3",{className:"wiki-pages-heading"},Object(v.mb)("Contents")),l.a.createElement("div",{className:"wiki-pages-container"},i.props.treeData&&l.a.createElement(D.a,{treeData:i.props.treeData,currentPath:i.props.currentPath,isNodeMenuShow:i.isNodeMenuShow,onNodeClick:i.props.onNodeClick,onNodeCollapse:i.props.onNodeCollapse,onNodeExpanded:i.props.onNodeExpanded})))},i.isNodeMenuShow=!1,i}return Object(i.a)(n,[{key:"render",value:function(){return l.a.createElement("div",{className:"side-panel wiki-side-panel ".concat(this.props.closeSideBar?"":"left-zero")},l.a.createElement("div",{className:"side-panel-top panel-top"},l.a.createElement(b.a,{onCloseSidePanel:this.props.onCloseSide})),l.a.createElement("div",{id:"side-nav",className:"wiki-side-nav",role:"navigation"},this.props.isTreeDataLoading&&l.a.createElement(C.a,null),!this.props.isTreeDataLoading&&this.props.indexNode&&this.renderIndexView(),!this.props.isTreeDataLoading&&!this.props.indexNode&&this.renderTreeView(),v.tc&&v.Tb&&l.a.createElement("div",{className:"text-left p-2"},l.a.createElement("a",{href:v.ic+"library/"+v.Ub+"/"+v.kc+"/",className:"text-dark text-decoration-underline"},Object(v.mb)("Go to Library")))))}}]),n}(s.Component),O=n(243),P=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onMouseEnter=function(){i.setState({highlight:!0})},i.onMouseLeave=function(){i.setState({highlight:!1})},i.onContextMenu=function(e){e.preventDefault(),e.stopPropagation()},i.onDirentClick=function(e){e.preventDefault(),i.props.onDirentClick(i.props.dirent)},i.state={highlight:!1},i}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.path,n=e.dirent,a=v.ic+"published"+k.a.joinPath(t,n.name),i=k.a.getDirentIcon(n);return k.a.isDesktop()?l.a.createElement("tr",{className:this.state.highlight?"tr-highlight":"",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onContextMenu:this.onContextMenu},l.a.createElement("td",{className:"text-center"},l.a.createElement("img",{src:i,width:"24",alt:""})),l.a.createElement("td",{className:"name"},l.a.createElement("a",{href:a,onClick:this.onDirentClick},n.name)),l.a.createElement("td",null,n.size),l.a.createElement("td",null,n.mtime_relative)):l.a.createElement("tr",null,l.a.createElement("td",{className:"text-center"},l.a.createElement("img",{src:i,width:"24",alt:""})),l.a.createElement("td",null,l.a.createElement("a",{href:a,onClick:this.onDirentClick},n.name),l.a.createElement("br",null),l.a.createElement("span",{className:"item-meta-info"},n.size),l.a.createElement("span",{className:"item-meta-info"},n.mtime_relative)))}}]),n}(l.a.Component),j=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=k.a.isDesktop();return l.a.createElement("table",{className:"table-hover ".concat(t?"":"table-thead-hidden")},l.a.createElement("thead",null,t?l.a.createElement("tr",null,l.a.createElement("th",{style:{width:"4%"}}),l.a.createElement("th",{style:{width:"66%"}},Object(v.mb)("Name")),l.a.createElement("th",{style:{width:"15%"}},Object(v.mb)("Size")),l.a.createElement("th",{style:{width:"15%"}},Object(v.mb)("Last Update"))):l.a.createElement("tr",null,l.a.createElement("th",{width:"12%"}),l.a.createElement("th",{width:"88%"}))),l.a.createElement("tbody",null,0!==this.props.direntList.length&&this.props.direntList.map((function(t,n){return l.a.createElement(P,{key:n,path:e.props.path,dirent:t,onDirentClick:e.props.onDirentClick})}))))}}]),n}(l.a.Component),T=n(257),F=n(290),R=n(50),z=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onMenuClick=function(){e.props.onMenuClick()},e.onEditClick=function(t){t.preventDefault();var n=v.ic+"lib/"+v.Ub+"/file"+e.props.path+"?mode=edit";window.open(n)},e.onMainNavBarClick=function(t){var n=k.a.getEventData(t,"path");e.props.onMainNavBarClick(n)},e.renderNavPath=function(){var t=e.props.path.split("/"),n="";return t.map((function(a,i){if(""!==a)return i===t.length-1?l.a.createElement(s.Fragment,{key:i},l.a.createElement("span",{className:"path-split"},"/"),l.a.createElement("span",{className:"path-file-name"},a)):(n+="/"+a,l.a.createElement(s.Fragment,{key:i},l.a.createElement("span",{className:"path-split"},"/"),l.a.createElement("a",{className:"path-link","data-path":n,onClick:e.onMainNavBarClick},a)))}))},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onSearchedClick,n=(e.permission,Object(v.mb)("Search files in this library")),a=l.a.createElement("div",{className:"message err-tip"},Object(v.mb)("Folder does not exist.")),i=this.props.pathExist&&!this.props.isDataLoading&&this.props.isViewFile;return l.a.createElement("div",{className:"main-panel wiki-main-panel o-hidden"},l.a.createElement("div",{className:"main-panel-north panel-top ".concat("rw"===this.props.permission?"border-left-show":"")},!v.tc&&l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"cur-view-toolbar"},l.a.createElement("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:"Side Nav Menu",onClick:this.onMenuClick})),l.a.createElement("div",{className:"common-toolbar"},v.wb&&l.a.createElement(T.a,{isPublic:!0,repoID:v.Ub,onSearchedClick:t,placeholder:n}))),v.tc&&l.a.createElement(s.Fragment,null,l.a.createElement("div",{className:"cur-view-toolbar"},l.a.createElement("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:"Side Nav Menu",onClick:this.onMenuClick}),"rw"==this.props.permission&&(k.a.isDesktop()?l.a.createElement("button",{className:"btn btn-secondary operation-item",title:Object(v.mb)("Edit"),onClick:this.onEditClick},Object(v.mb)("Edit")):l.a.createElement("span",{className:"fa fa-pencil-alt mobile-toolbar-icon",title:Object(v.mb)("Edit"),onClick:this.onEditClick,style:{"font-size":"1.1rem"}}))),l.a.createElement("div",{className:"common-toolbar"},v.wb&&l.a.createElement(T.a,{isPublic:!0,repoID:v.Ub,onSearchedClick:t,placeholder:n}),l.a.createElement(F.a,null),l.a.createElement(R.a,null)))),l.a.createElement("div",{className:"main-panel-center"},l.a.createElement("div",{className:"cur-view-path"},l.a.createElement("div",{className:"path-container"},l.a.createElement("a",{href:v.ic+"published/"+v.kc,className:"normal"},v.kc),this.renderNavPath())),l.a.createElement("div",{className:"cur-view-content ".concat(i?"o-hidden":"")},!this.props.pathExist&&a,this.props.pathExist&&this.props.isDataLoading&&l.a.createElement(C.a,null),i&&l.a.createElement(O.a,{markdownContent:this.props.content,isFileLoading:this.props.isDataLoading,lastModified:this.props.lastModified,latestContributor:this.props.latestContributor,onLinkClick:this.props.onLinkClick,isWiki:!0,path:this.props.path}),!this.props.isDataLoading&&!this.props.isViewFile&&l.a.createElement(j,{path:this.props.path,direntList:this.props.direntList,onDirentClick:this.props.onDirentClick}))))}}]),n}(s.Component),B=(n(135),n(1106),n(1107),n(93),n(106),function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).loadWikiData=function(e){if(i.loadSidePanel(e),"None"===v.tb)if("/home.md"===e)i.showDir("/");else{i.setState({pathExist:!1});var t=v.ic+"published/"+v.kc+k.a.encodePath(e);window.history.pushState({url:t,path:e},e,t)}else"True"===v.tb?i.showDir(e):"False"===v.tb&&i.showFile(e)},i.loadSidePanel=function(e){v.nb?i.loadIndexNode():"None"===v.tb?(e="/",i.loadNodeAndParentsByPath("/")):i.loadNodeAndParentsByPath(e)},i.loadIndexNode=function(){g.a.listWikiDir(v.kc,"/").then((function(e){var t=i.state.treeData;i.addFirstResponseListToNode(e.data.dirent_list,t.root);var n=t.getNodeByPath(i.indexPath);g.a.getWikiFileContent(v.kc,n.path).then((function(e){i.setState({treeData:t,indexNode:n,indexContent:e.data.content,isTreeDataLoading:!1})}))})).catch((function(){i.setState({isLoadFailed:!0})}))},i.showDir=function(e){i.loadDirentList(e);var t=v.ic+"published/"+v.kc+k.a.encodePath(e);window.history.pushState({url:t,path:e},e,t)},i.showFile=function(e){i.setState({isDataLoading:!0,isViewFile:!0,path:e}),g.a.getWikiFileContent(v.kc,e).then((function(e){var t=e.data;i.setState({isDataLoading:!1,content:t.content,permission:t.permission,lastModified:h.a.unix(t.last_modified).fromNow(),latestContributor:t.latest_contributor})}));var t=window.location.hash,n=v.ic+"published/"+v.kc+k.a.encodePath(e)+t;"/home.md"===e?window.history.replaceState({url:n,path:e},e,n):window.history.pushState({url:n,path:e},e,n)},i.loadDirentList=function(e){i.setState({isDataLoading:!0}),g.a.listWikiDir(v.kc,e).then((function(t){var n=t.data.dirent_list.map((function(e){return new E.a(e)}));"/"===e&&(n=n.filter((function(e){if("dir"===e.type){var t=e.name.toLowerCase();return"drafts"!==t&&"images"!==t&&"downloads"!==t}return!0}))),n=k.a.sortDirents(n,"name","asc"),i.setState({path:e,isViewFile:!1,direntList:n,isDataLoading:!1})})).catch((function(){i.setState({isLoadFailed:!0})}))},i.loadTreeNodeByPath=function(e){var t=i.state.treeData.clone(),n=t.getNodeByPath(e);n.isLoaded?(t.getNodeByPath(n.parentNode.path).isExpanded=!0,i.setState({treeData:t,currentNode:n})):g.a.listWikiDir(v.kc,n.path).then((function(e){i.addResponseListToNode(e.data.dirent_list,n),t.getNodeByPath(n.parentNode.path).isExpanded=!0,i.setState({treeData:t,currentNode:n})}))},i.loadNodeAndParentsByPath=function(e){var t=i.state.treeData.clone();k.a.isMarkdownFile(e)&&(e=k.a.getDirName(e)),g.a.listWikiDir(v.kc,e,!0).then((function(e){for(var n=e.data.dirent_list,a={},o=0;o<n.length;o++){var r=n[o],s=r.parent_dir;a[s]||(a[s]=[]),a[s].push(r)}for(var l in a){var c=t.getNodeByPath(l);c.isLoaded||"/"!==c.path?c.isLoaded||i.addResponseListToNode(a[l],c):i.addFirstResponseListToNode(a[l],c)}i.setState({isTreeDataLoading:!1,treeData:t})})).catch((function(){i.setState({isLoadFailed:!0})}))},i.onLinkClick=function(e){var t=e;if(k.a.isWikiInternalMarkdownLink(t,v.kc)){var n=k.a.getPathFromWikiInternalMarkdownLink(t,v.kc);i.showFile(n)}else if(k.a.isWikiInternalDirLink(t,v.kc)){var a=k.a.getPathFromWikiInternalDirLink(t,v.kc);i.showDir(a)}else window.location.href=t;i.state.closeSideBar||i.setState({closeSideBar:!0})},i.onpopstate=function(e){if(e.state&&e.state.path){var t=e.state.path;k.a.isMarkdownFile(t)?i.showFile(t):(i.loadDirentList(t),i.setState({path:t,isViewFile:!1}))}},i.onSearchedClick=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(i.state.currentPath!==t){for(var n=-1,a=k.a.getPaths(t),o=0;o<a.length;o++){var r=i.state.treeData.getNodeByPath(r);if(!r){n=o;break}}if(-1===n){var s=i.state.treeData.clone(),l=s.getNodeByPath(e.path);N.a.expandNode(l),i.setState({treeData:s})}else i.loadNodeAndParentsByPath(t);if(e.is_dir)i.showDir(t);else if(k.a.isMarkdownFile(t))i.showFile(t);else{var c=v.ic+"d/"+v.ec+"/files/?p="+k.a.encodePath(t);window.open("about:blank").location.href=c}}},i.onMenuClick=function(){i.setState({closeSideBar:!i.state.closeSideBar})},i.onMainNavBarClick=function(e){var t=i.state.treeData.clone(),n=t.getNodeByPath(e);t.expandNode(n),i.setState({treeData:t,currentNode:n}),i.showDir(n.path)},i.onDirentClick=function(e){var t=k.a.joinPath(i.state.path,e.name);if(e.isDir())i.loadTreeNodeByPath(t),i.showDir(t);else if(k.a.isMarkdownFile(t))i.showFile(t);else{var n=window.open("about:blank"),a=v.ic+"d/"+v.ec+"/files/?p="+k.a.encodePath(t);n.location.href=a}},i.onCloseSide=function(){i.setState({closeSideBar:!i.state.closeSideBar})},i.onNodeClick=function(e){if(i.state.pathExist||i.setState({pathExist:!0}),e.object.isDir()){if(!e.isLoaded){var t=i.state.treeData.clone();e=t.getNodeByPath(e.path),g.a.listWikiDir(v.kc,e.path).then((function(n){i.addResponseListToNode(n.data.dirent_list,e),t.collapseNode(e),i.setState({treeData:t})}))}if(e.path===i.state.path)if(e.isExpanded){var n=N.a.collapseNode(i.state.treeData,e);i.setState({treeData:n})}else{var a=i.state.treeData.clone();e=a.getNodeByPath(e.path),a.expandNode(e),i.setState({treeData:a})}}if(e.path!==i.state.path)if(e.object.isDir())i.showDir(e.path);else if(k.a.isMarkdownFile(e.path))e.path!==i.state.path&&i.showFile(e.path);else{var o=window.open("about:blank"),r=v.ic+"d/"+v.ec+"/files/?p="+k.a.encodePath(e.path);o.location.href=r}},i.onNodeCollapse=function(e){var t=N.a.collapseNode(i.state.treeData,e);i.setState({treeData:t})},i.onNodeExpanded=function(e){var t=i.state.treeData.clone();(e=t.getNodeByPath(e.path)).isLoaded?(t.expandNode(e),i.setState({treeData:t})):g.a.listWikiDir(v.kc,e.path).then((function(n){i.addResponseListToNode(n.data.dirent_list,e),i.setState({treeData:t})}))},i.addFirstResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new E.a(e)}));n=n.filter((function(e){if("dir"===e.type){var t=e.name.toLowerCase();return"drafts"!==t&&"images"!==t&&"downloads"!==t}return!0}));var a=(n=k.a.sortDirents(n,"name","asc")).map((function(e){return new w.a({object:e})}));t.addChildren(a)},i.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map((function(e){return new E.a(e)})),a=(n=k.a.sortDirents(n,"name","asc")).map((function(e){return new w.a({object:e})}));t.addChildren(a)},i.state={path:"",pathExist:!0,closeSideBar:!1,isViewFile:!0,isDataLoading:!0,direntList:[],content:"",permission:"",lastModified:"",latestContributor:"",isTreeDataLoading:!0,treeData:N.a.buildTree(),currentNode:null,indexNode:null,indexContent:""},window.onpopstate=i.onpopstate,i.indexPath="/index.md",i.homePath="/home.md",i}return Object(i.a)(n,[{key:"componentWillMount",value:function(){k.a.isDesktop()||this.setState({closeSideBar:!0})}},{key:"componentDidMount",value:function(){this.loadWikiData(v.qb)}},{key:"render",value:function(){return l.a.createElement("div",{id:"main",className:"wiki-main"},l.a.createElement(x,{isTreeDataLoading:this.state.isTreeDataLoading,closeSideBar:this.state.closeSideBar,currentPath:this.state.path,treeData:this.state.treeData,indexNode:this.state.indexNode,indexContent:this.state.indexContent,onCloseSide:this.onCloseSide,onNodeClick:this.onNodeClick,onNodeCollapse:this.onNodeCollapse,onNodeExpanded:this.onNodeExpanded,onLinkClick:this.onLinkClick}),l.a.createElement(z,{path:this.state.path,pathExist:this.state.pathExist,isViewFile:this.state.isViewFile,isDataLoading:this.state.isDataLoading,content:this.state.content,permission:this.state.permission,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,direntList:this.state.direntList,onLinkClick:this.onLinkClick,onMenuClick:this.onMenuClick,onSearchedClick:this.onSearchedClick,onMainNavBarClick:this.onMainNavBarClick,onDirentClick:this.onDirentClick}),l.a.createElement(m.a,{query:"(max-width: 767.8px)"},l.a.createElement(f.x,{isOpen:!this.state.closeSideBar,toggle:this.onCloseSide,contentClassName:"d-none"})))}}]),n}(s.Component));d.a.render(l.a.createElement(B,null),document.getElementById("wrapper"))},243:function(e,t,n){"use strict";var a=n(5),i=n(6),o=n(8),r=n(7),s=n(0),l=n.n(s),c=n(88),d=n(1),p=n(3),h=n(14),u=n(9),m=n(4),f=n(10),v=(n(397),"wiki-page-content"),k=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onContentRendered=function(e){i.titlesInfo=e.titlesInfo},i.listRelatedFiles=function(){i.props.repoID&&i.props.path&&u.a.listRelatedFiles(i.props.repoID,i.props.path).then((function(e){i.setState({relatedFiles:e.data.related_files})})).catch((function(e){var t=m.a.getErrorMsg(e);f.a.danger(t)}))},i.onLinkClick=function(e){e.preventDefault(),e.stopPropagation();var t="";if("A"!==e.target.tagName){for(var n=e.target.parentNode;"A"!==n.tagName;)n=n.parentNode;t=n.href}else t=e.target.href;i.props.onLinkClick(t)},i.onScrollHandler=function(){var e,t=i.markdownContainer.current.scrollTop+180,n=i.titlesInfo.length;if(t<=i.titlesInfo[0])return e=0,void i.setState({activeTitleIndex:e});if(t>i.titlesInfo[n-1])return e=i.titlesInfo.length-1,void i.setState({activeTitleIndex:e});for(var a=0;a<n;a++)if(!(t>i.titlesInfo[a])){e=a-1;break}i.setState({activeTitleIndex:e})},i.changeInlineNode=function(e){var t,n;if("inline"==e.object)if("image"==e.type&&d.xb){if(t=e.data.src,new RegExp(d.Zb+"/lib/"+d.Ub+"/file.*raw=1").test(t)){var a=t.indexOf("/file"),o=t.indexOf("?");n=t.substring(a+5,o)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var r=i.props.path,s=r.slice(0,r.lastIndexOf("/"))+"/"+t;n=m.a.pathNormalize(s)}e.data.src=d.Zb+"/view-image-via-public-wiki/?slug="+d.kc+"&path="+n}else if("link"==e.type)if(t=e.data.href,m.a.isInternalFileLink(t,d.Ub))if(m.a.isInternalMarkdownLink(t,d.Ub)){var l=m.a.getPathFromInternalMarkdownLink(t,d.Ub);e.data.href=d.Zb+"/published/"+d.kc+l}else e.data.href=t.replace(/(.*)lib\/([-0-9a-f]{36})\/file(.*)/g,(function(e,t,n,a){return"".concat(t,"d/").concat(d.ec,"/files/?p=").concat(a,"&dl=1")}));else if(m.a.isInternalDirLink(t,d.Ub)){var c=m.a.getPathFromInternalDirLink(t,d.Ub);e.data.href=d.Zb+"/published/"+d.kc+c}return e},i.modifyValueBeforeRender=function(e){return m.a.changeMarkdownNodes(e,i.changeInlineNode)},i.renderMarkdown=function(){var e=!0;return!1===i.props.isTOCShow&&(e=!1),i.props.isWiki?l.a.createElement(c.a,{showTOC:e,markdownContent:i.props.markdownContent,activeTitleIndex:i.state.activeTitleIndex,onContentRendered:i.onContentRendered,modifyValueBeforeRender:i.modifyValueBeforeRender}):l.a.createElement(c.a,{showTOC:e,markdownContent:i.props.markdownContent,activeTitleIndex:i.state.activeTitleIndex,onContentRendered:i.onContentRendered})},i.renderRelatedFiles=function(){var e=i.state.relatedFiles;return e.length>0?l.a.createElement("div",{className:"sf-releted-files",id:"sf-releted-files"},l.a.createElement("div",{className:"sf-releted-files-header"},l.a.createElement("h4",null,Object(d.mb)("related files"))),e.map((function(e,t){var n=d.ic+"lib/"+e.repo_id+"/file"+m.a.encodePath(e.path);return l.a.createElement("div",{className:"sf-releted-file",key:t},l.a.createElement("a",{href:n,target:"_blank"},l.a.createElement(p.f,{body:!0,size:"sm"},l.a.createElement(p.h,null,e.name),l.a.createElement(p.g,null,e.repo_name),l.a.createElement("span",{className:"sf-releted-file-arrow"}))))}))):null},i.state={activeTitleIndex:0,relatedFiles:[]},i.markdownContainer=l.a.createRef(),i.links=[],i.titlesInfo=[],i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.links=document.querySelectorAll(".".concat(v," a")),this.links.forEach((function(t){t.addEventListener("click",e.onLinkClick)})),this.listRelatedFiles()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.markdownContent!==e.markdownContent&&(this.links.forEach((function(e){e.removeEventListener("click",t.onLinkClick)})),this.listRelatedFiles())}},{key:"componentDidUpdate",value:function(){var e=this;this.links=document.querySelectorAll(".".concat(v," a")),this.links.forEach((function(t){t.addEventListener("click",e.onLinkClick)}))}},{key:"componentWillUnmount",value:function(){var e=this;this.links.forEach((function(t){t.removeEventListener("click",e.onLinkClick)}))}},{key:"render",value:function(){if(this.props.isFileLoading)return l.a.createElement(h.a,null);var e="".concat(this.props.repoID?v+" w-100":v);return l.a.createElement("div",{ref:this.markdownContainer,className:"wiki-page-container",onScroll:this.onScrollHandler.bind(this)},l.a.createElement("div",{className:e},this.props.children,this.renderMarkdown(),this.props.isWiki&&this.renderRelatedFiles(),l.a.createElement("p",{id:"wiki-page-last-modified"},Object(d.mb)("Last modified by")," ",this.props.latestContributor,", ",l.a.createElement("span",null,this.props.lastModified))))}}]),n}(l.a.Component);c.a.defaultProps={isWiki:!1},t.a=k},253:function(e,t,n){"use strict";var a=n(5),i=n(6),o=n(8),r=n(7),s=n(0),l=n.n(s),c=n(31),d=n(1),p=n(112),h=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onMouseEnter=function(){i.props.isItemFreezed||i.setState({isShowOperationMenu:!0,isHighlight:!0})},i.onMouseOver=function(){i.props.isItemFreezed||i.setState({isShowOperationMenu:!0,isHighlight:!0})},i.onMouseLeave=function(){i.props.isItemFreezed||i.setState({isShowOperationMenu:!1,isHighlight:!1})},i.onNodeClick=function(){i.props.onNodeClick(i.props.node)},i.onLoadToggle=function(e){e.stopPropagation();var t=i.props.node;t.isExpanded?i.props.onNodeCollapse(t):i.props.onNodeExpanded(t)},i.onNodeDragStart=function(e){i.props.onNodeDragStart(e,i.props.node)},i.onNodeDragEnter=function(e){"dir"===i.props.node.object.type&&i.setState({isNodeDropShow:!0}),i.props.onNodeDragEnter(e,i.props.node)},i.onNodeDragMove=function(e){i.props.onNodeDragMove(e)},i.onNodeDragLeave=function(e){i.setState({isNodeDropShow:!1}),i.props.onNodeDragLeave(e,i.props.node)},i.onNodeDrop=function(e){e.stopPropagation(),i.setState({isNodeDropShow:!1}),i.props.onNodeDrop(e,i.props.node)},i.unfreezeItem=function(){i.setState({isShowOperationMenu:!1}),i.props.unfreezeItem()},i.onMenuItemClick=function(e,t,n){i.props.onMenuItemClick(e,n)},i.onItemMouseDown=function(e){e.stopPropagation(),e.button},i.onItemContextMenu=function(e){i.handleContextClick(e)},i.handleContextClick=function(e){i.props.handleContextClick(e,i.props.node),i.setState({isShowOperationMenu:!1})},i.getNodeTypeAndIcon=function(){var e=i.props.node,t="",n="";if("dir"===e.object.type)t=l.a.createElement("i",{className:"far fa-folder"}),n="dir";else{var a=e.object.name.lastIndexOf(".");if(-1===a)t=l.a.createElement("i",{className:"far fa-file"}),n="file";else{var o=e.object.name.slice(a).toLowerCase();".png"===o||".jpg"===o||".jpeg"===o||".gif"===o||".bmp"===o?(t=l.a.createElement("i",{className:"far fa-image"}),n="image"):".md"===o||".markdown"===o?(t=l.a.createElement("i",{className:"far fa-file-alt"}),n="file"):(t=l.a.createElement("i",{className:"far fa-file"}),n="file")}}return{icon:t,type:n}},i.renderChildren=function(){var e=i.props,t=e.node,a=e.paddingLeft;return t.hasChildren()?l.a.createElement("div",{className:"children",style:{paddingLeft:a}},t.children.map((function(e){return l.a.createElement(n,{key:e.path,node:e,paddingLeft:a,repoPermission:i.props.repoPermission,currentPath:i.props.currentPath,isNodeMenuShow:i.props.isNodeMenuShow,isItemFreezed:i.props.isItemFreezed,onNodeClick:i.props.onNodeClick,onNodeCollapse:i.props.onNodeCollapse,onNodeExpanded:i.props.onNodeExpanded,freezeItem:i.props.freezeItem,onMenuItemClick:i.props.onMenuItemClick,unfreezeItem:i.unfreezeItem,onNodeDragStart:i.props.onNodeDragStart,onNodeDragMove:i.props.onNodeDragMove,onNodeDrop:i.props.onNodeDrop,onNodeDragEnter:i.props.onNodeDragEnter,onNodeDragLeave:i.props.onNodeDragLeave,handleContextClick:i.props.handleContextClick})}))):""},i.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1},i}return Object(i.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"caculateMenuList",value:function(e){var t=c.a.NEW_FOLDER,n=c.a.NEW_FILE,a=c.a.COPY,i=c.a.MOVE,o=c.a.RENAME,r=c.a.DELETE,s=c.a.OPEN_VIA_CLIENT;return"dir"===e.object.type?[t,n,a,i,o,r]:[o,r,a,i,s]}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,a=e.isNodeMenuShow,i=this.getNodeTypeAndIcon(),o=i.type,r=i.icon,s=this.state.isHighlight?"tree-node-inner-hover ":"";return n.path===t&&(s="tree-node-hight-light"),l.a.createElement("div",{className:"tree-node"},l.a.createElement("div",{type:o,className:"tree-node-inner text-nowrap ".concat(s," ").concat("/"===n.path?"hide":""," ").concat(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick},l.a.createElement("div",{className:"tree-node-text",draggable:"true",onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop},n.object.name),l.a.createElement("div",{className:"left-icon"},"dir"===o&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&l.a.createElement("i",{className:"folder-toggle-icon fa ".concat(n.isExpanded?"fa-caret-down":"fa-caret-right"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),l.a.createElement("i",{className:"tree-node-icon"},r)),a&&l.a.createElement("div",{className:"right-icon"},(this.props.repoPermission||d.Tb)&&this.state.isShowOperationMenu&&l.a.createElement(p.a,{item:this.props.node,toggleClass:"fas fa-ellipsis-v",getMenuList:this.caculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem}))),n.isExpanded&&this.renderChildren())}}]),n}(l.a.Component),u=n(102),m=n(45),f=n(4),v=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onItemMove=function(e,t,n,a){i.props.onItemMove(e,t,n,a)},i.onNodeDragStart=function(e,t){if(f.a.isIEBrower())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",n)},i.onNodeDragEnter=function(e,t){if(f.a.isIEBrower())return!1;e.persist(),"tree-view tree "===e.target.className&&i.setState({isTreeViewDropTipShow:!0})},i.onNodeDragMove=function(e){if(f.a.isIEBrower())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},i.onNodeDragLeave=function(e,t){if(f.a.isIEBrower())return!1;"tree-view tree tree-view-drop"===e.target.className&&i.setState({isTreeViewDropTipShow:!1})},i.onNodeDrop=function(e,t){if(f.a.isIEBrower())return!1;if(!e.dataTransfer.files.length){var n=e.dataTransfer.getData("applicaiton/drag-item-info"),a=n=JSON.parse(n),o=a.nodeDirent,r=a.nodeParentPath,s=a.nodeRootPath,l=t;if(Array.isArray(n))return l?void i.onMoveItems(n,l,i.props.currentRepoInfo,l.path):("/"===n[0].nodeParentPath||i.props.onItemsMove(i.props.currentRepoInfo,"/"),void i.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===r||i.onItemMove(i.props.currentRepoInfo,o,"/",r),void i.setState({isTreeViewDropTipShow:!1});if("dir"===l.object.type&&r!==l.path&&(r!==l.parentNode.path||l.object.name!==o.name)){if("dir"===l.object.type&&"dir"===o.type)if(l.parentNode.path!==r)if(f.a.getPaths(l.path).includes(s))return;i.onItemMove(i.props.currentRepoInfo,o,l.path,r)}}},i.onMoveItems=function(e,t,n,a){var o=[],r=f.a.getPaths(a);(e.forEach((function(e){var t=e.nodeRootPath;o.push(t)})),"dir"===t.object.type)&&(o.some((function(e){return e===a}))||e[0].nodeParentPath&&e[0].nodeParentPath===t.path||o.some((function(e){return r.includes(e)}))||i.props.onItemsMove(n,a))},i.freezeItem=function(){i.setState({isItemFreezed:!0})},i.unfreezeItem=function(){i.setState({isItemFreezed:!1})},i.onMenuItemClick=function(e,t){i.props.onMenuItemClick(e,t),Object(m.c)()},i.onMouseDown=function(e){e.stopPropagation(),e.button},i.onContextMenu=function(e){e.preventDefault();var t=i.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";i.handleContextClick(e)},i.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),i.props.isNodeMenuShow){var n=e.clientX||e.touches&&e.touches[0].pageX,a=e.clientY||e.touches&&e.touches[0].pageY;i.props.posX&&(n-=i.props.posX),i.props.posY&&(a-=i.props.posY),Object(m.c)();var o=i.getMenuList(t),r={id:"tree-node-contextmenu",position:{x:n,y:a},target:e.target,currentObject:t,menuList:o};Object(m.d)(r)}},i.getMenuList=function(e){var t=c.a.NEW_FOLDER,n=c.a.NEW_FILE,a=c.a.COPY,i=c.a.MOVE,o=c.a.RENAME,r=c.a.DELETE,s=c.a.OPEN_VIA_CLIENT;return e?"dir"===e.object.type?[t,n,a,i,o,r]:[o,r,a,i,s]:[t,n]},i.onShowMenu=function(){i.freezeItem()},i.onHideMenu=function(){i.unfreezeItem()},i.state={isItemFreezed:!1,isTreeViewDropTipShow:!1},i}return Object(i.a)(n,[{key:"render",value:function(){return l.a.createElement("div",{className:"tree-view tree ".concat(this.state.isTreeViewDropTipShow?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu},l.a.createElement(h,{repoPermission:this.props.repoPermission,node:this.props.treeData.root,currentPath:this.props.currentPath,paddingLeft:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.props.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),l.a.createElement(u.a,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu}))}}]),n}(l.a.Component);t.a=v},397:function(e,t,n){},45:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(76),i=n.n(a),o=n(64),r="REACT_CONTEXTMENU_SHOW",s="REACT_CONTEXTMENU_HIDE";function l(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;"function"===typeof window.CustomEvent?n=new window.CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,t),a&&(a.dispatchEvent(n),i()(o.d,t))}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(r,i()({},e,{type:r}),t)}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;l(s,i()({},e,{type:s}),t)}},64:function(e,t,n){"use strict";function a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return"function"===typeof e&&e.apply(void 0,n)}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(){return Math.random().toString(36).substring(7)}n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s}));var r={},s=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},95:function(e,t,n){"use strict";var a=n(5),i=n(45),o=n(64);t.a=new function e(){var t=this;Object(a.a)(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)Object(o.c)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)Object(o.c)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var a=Object(o.e)();return t.callbacks[a]={show:e,hide:n},a},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},o.b&&(window.addEventListener(i.b,this.handleShowEvent),window.addEventListener(i.a,this.handleHideEvent))}}},[[1103,1,0]]]);
//# sourceMappingURL=wiki.chunk.js.map